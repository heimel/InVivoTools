function GammaCorrectionTable = LoadGammaCorrectionTable(filename)%  LOADGAMMACORRECTIONTABLE - Loads gamma correction table for NewStim%%  LOADGAMMACORECTIONTABLE(FILENAME)%%  Loads gamma correction table for NewStim package.%%  The gamma correction table allows one to correct for luminance non-linearities%  that are found in most monitors.  For example, setting the screen rgb color to%  [128 128 128] rarely produces exactly half the luminance of [255 255 255].%%  The table should be in an ascii file.  The first column should be the vector%  0..255 indicating desired gun brightness from 0 to 255.  The remaining%  columns should be the actual gun brightness that NewStim should use for each%  desired brightness.  If one column of gun brightness is given, then this%  correction factor is applied to all three color channels, r, g, and b.%  If three columns of gun brightness are given, then they indicate %  r, g, and b, respectively.%%  See also;  GAMMACORRECTIONTABLEGLOBALS, APPLYGAMMACORRECTIONGammaCorrectionTableGlobals;GammaCorrectionTable = [];if ~GammaCorrectionEnable    returnendif ~exist(filename,'file')    filename = fullfile(fileparts(which('monitor_calibrations.m')),filename);    if ~exist(filename,'file')        error('LOADGAMMACORRECTIONTABLE:NO_FILE','Cannot find monitor calibration file.');    endend    table = load(filename,'-ascii');if size(table,1)~=256 || ~all(table(:,1)==(0:255)')	error(['Improper format for gamma correction table in file ' filename ': first row must be (0:255)''.']);endif size(table,2)~=2&&size(table,2)~=4	error(['Improper format for gamma correction table in file ' filename ': must have 2 or 4 rows.']);endif size(table,2)==2	table(:,3) = table(:,2);	table(:,4) = table(:,2);endGammaCorrectionTable = table(:,2:4);